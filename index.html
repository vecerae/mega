<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Provably Fair Bitcoin Cycle</title>

  <style>
    :root {
      --bg: #0b0f14;
      --card: #121826;
      --muted: #9aa4b2;
      --accent: #22c55e;
      --accent2: #38bdf8;
      --danger: #ef4444;
      --border: #1f2937;
    }

    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(180deg, #0b0f14, #0e1420);
      color: #e5e7eb;
    }

    .container {
      max-width: 1100px;
      margin: auto;
      padding: 32px 16px 120px;
    }

    h1, h2, h3 {
      margin-top: 0;
      letter-spacing: -0.02em;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 10px 30px rgba(0,0,0,.3);
    }

    .wallet {
      font-size: 1.05rem;
      word-break: break-all;
      padding: 12px;
      background: #020617;
      border-radius: 12px;
      border: 1px dashed var(--border);
    }

    .badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 600;
      background: rgba(34,197,94,.15);
      color: var(--accent);
      border: 1px solid rgba(34,197,94,.4);
    }

    .muted { color: var(--muted); }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }

    th, td {
      padding: 10px 8px;
      border-bottom: 1px solid var(--border);
      text-align: left;
    }

    th { color: var(--muted); font-weight: 600; }

    button {
      background: linear-gradient(135deg, var(--accent), #16a34a);
      border: none;
      border-radius: 10px;
      padding: 10px 14px;
      font-weight: 700;
      color: #052e16;
      cursor: pointer;
    }

    button.secondary {
      background: transparent;
      color: var(--accent2);
      border: 1px solid var(--border);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
    }

    .code {
      font-family: monospace;
      font-size: 0.8rem;
      background: #020617;
      padding: 12px;
      border-radius: 8px;
      overflow-x: auto;
    }
  </style>
</head>
<body>

<div class="container">

  <!-- HEADER -->
  <div class="card">
    <h1>Provably Fair Bitcoin Cycle</h1>
    <p class="muted">100% on-chain • No API • No owner control • Fully auditable by anyone</p>

    <h3>Receiving Wallet</h3>
    <div class="wallet" id="wallet">bc1qmxcgv8wtj7zdx8t9xtr6xcfx5yuqeddqwx5wca</div>

    <div style="margin-top:12px">
      <span class="badge" id="cycleStatus">Cycle open</span>
    </div>
  </div>

  <!-- LIVE CYCLE DATA -->
  <div class="grid">
    <div class="card">
      <h3>Current Cycle</h3>
      <p><b>Entries:</b> <span id="entriesCount">0</span> / 200</p>
      <p><b>Remaining:</b> <span id="entriesRemaining">200</span></p>
      <p><b>Fixed Entry Value:</b> 0.00014000 BTC</p>
    </div>

    <div class="card">
      <h3>Seed & Randomness</h3>
      <p class="muted">Automatically locked when entry #200 confirms</p>
      <p><b>Seed blockhash:</b></p>
      <div class="code" id="seedBlock">Waiting for cycle close…</div>
    </div>

    <div class="card">
      <h3>Winner Calculation</h3>
      <p><b>Winner index:</b></p>
      <div class="code" id="winnerIndex">—</div>
      <p class="muted">Calculated live from SHA‑256(seed_material)</p>
    </div>
  </div>

  <!-- FINGERPRINT -->
  <div class="card">
    <h3>Public Fingerprint (Immutable)</h3>
    <p class="muted">This hash permanently commits the cycle inputs and order</p>
    <div class="code" id="fingerprint">—</div>
  </div>

  <!-- ACTIONS -->
  <div class="grid">
    <div class="card">
      <h3>Transparency Tools</h3>
      <button onclick="exportCSV()">Export cycle entries (CSV)</button>
    </div>

    <div class="card">
      <h3>Latest Winners</h3>
      <table id="winnersTable">
        <thead>
          <tr><th>TxID</th><th>Winner address</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- FULL AUDIT -->
  <div class="card">
    <h2>How anyone can audit this (no trust required)</h2>
    <p>
      Every rule, number and result shown above is derived exclusively from public
      Bitcoin blockchain data. No private server, no API, no owner discretion.
    </p>

    <ol>
      <li>All entries are sent to a single public address with an exact fixed value.</li>
      <li>Entries are ordered deterministically by blockheight, txid and vout.</li>
      <li>When entry #200 confirms, the cycle locks automatically.</li>
      <li>The closing blockhash becomes the unpredictable seed.</li>
      <li>A SHA‑256 hash commits the full ordered list (fingerprint).</li>
      <li>The winner index is SHA‑256(seed) mod 200.</li>
      <li>The payout transaction is publicly verifiable on‑chain.</li>
    </ol>

    <h3>Common questions — answered</h3>
    <p><b>“Does the owner have any advantage?”</b><br>
      No. The owner cannot influence blockhashes, entry order or winner calculation.
    </p>

    <p><b>“Are there hidden fees?”</b><br>
      No. All entries are identical and all payouts are visible on‑chain.
      Network fees are paid by the operator and do not affect fairness.
    </p>

    <p><b>“Can results be changed later?”</b><br>
      No. The fingerprint hash permanently fixes the cycle inputs.
    </p>

    <p class="muted">This system is designed to be verifiable even if the website disappears.</p>
  </div>

</div>

<script>
  // ===== MOCK DATA (replace with on-chain extraction logic) =====
  const entries = [];
  const winners = [];

  function updateUI() {
    const count = entries.length;
    document.getElementById('entriesCount').innerText = count;
    document.getElementById('entriesRemaining').innerText = 200 - count;

    if (count >= 200) {
      document.getElementById('cycleStatus').innerText = 'Cycle locked – awaiting payout';
      document.getElementById('seedBlock').innerText = 'BLOCKHASH_EXAMPLE';
      document.getElementById('winnerIndex').innerText = 'sha256(seed) % 200 = 42';
      document.getElementById('fingerprint').innerText = 'SHA256_FINGERPRINT_EXAMPLE';
    }
  }

  function exportCSV() {
    let csv = 'blockheight,txid,vout\n';
    entries.forEach(e => {
      csv += `${e.blockheight},${e.txid},${e.vout}\n`;
    });

    const blob = new Blob([csv], { type: 'text/csv' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'cycle_entries.csv';
    a.click();
  }

  updateUI();
</script>

</body>
</html>
